<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Visimos Web Demo — Fullscreen + Recorder</title>
<style>
  html,body{height:100%;margin:0;background:#000;color:#fff;font-family:system-ui,Roboto,Segoe UI,Arial}
  .app{height:100vh;display:flex;flex-direction:column;align-items:stretch;overflow:hidden}
  #stage{position:relative;flex:1;background:#000}
  video#camera{display:none}
  canvas#process{display:none}
  canvas#overlay{position:absolute;inset:0;width:100%;height:100%;touch-action:none}
  .ui{position:absolute;left:10px;top:10px;z-index:60;max-width:92vw}
  .panel{background:rgba(0,0,0,0.46);padding:8px;border-radius:10px;backdrop-filter:blur(6px)}
  textarea{width:360px;max-width:86vw;height:110px;background:rgba(255,255,255,0.03);color:#fff;border:1px solid rgba(255,255,255,0.06);border-radius:6px;padding:8px;font-family:monospace}
  button{margin:6px 6px 0 0;padding:8px 12px;border-radius:8px;border:0;background:#0ea5e9;color:#041014;font-weight:700}
  .small{padding:6px 8px;font-size:13px}
  .badge{position:absolute;right:12px;top:12px;background:rgba(0,0,0,0.6);border-radius:8px;padding:6px 10px;color:#fff;font-weight:700;z-index:70}
  .signal{position:absolute;left:50%;transform:translateX(-50%);bottom:18px;background:rgba(255,255,255,0.95);color:#000;padding:10px 16px;border-radius:18px;font-weight:700;z-index:70;display:none}
  .robotSim{position:absolute;right:12px;bottom:12px;z-index:71;display:flex;gap:8px}
  .big{font-size:18px;padding:12px 16px}
  .hidden{display:none !important}
  .topbar{display:flex;gap:8px;align-items:center}
  .mini{font-size:12px;padding:6px 8px;background:rgba(255,255,255,0.04);border-radius:6px}
  #fps{font-size:12px;opacity:0.9;margin-left:8px}
</style>
</head>
<body>
<div class="app">
  <div id="stage">
    <video id="camera" autoplay playsinline muted></video>
    <canvas id="process"></canvas>
    <canvas id="overlay"></canvas>

    <div class="ui panel" id="controls">
      <div class="topbar">
        <strong>Visimos Web — Demo</strong>
        <div id="fps" class="mini">fps</div>
        <div style="flex:1"></div>
        <button id="fullscreenToggle" class="mini">Fullscreen demo</button>
      </div>

      <div style="margin-top:8px;">
        <textarea id="rules"># Example rules
see thing when moving -> glow
see thing when close -> stop
see thing -> remember
see thing when remembered -> signal "hello"
</textarea>
      </div>

      <div style="margin-top:8px;display:flex;flex-wrap:wrap;gap:8px;align-items:center">
        <button id="runRules" class="small">Run rules</button>
        <button id="exportRules" class="small">Export rules</button>
        <button id="importRulesBtn" class="small">Import rules</button>
        <input id="importFile" type="file" accept=".txt,.vis" style="display:none" />
        <button id="clearMemory" class="small">Clear memory</button>
        <button id="recordDemo" class="small">Record 10s</button>
        <div style="flex:1"></div>
        <button id="robotDemo" class="small">Robot demo</button>
      </div>

      <div style="margin-top:8px;font-size:13px;opacity:0.9" id="status">Status: waiting for camera...</div>
    </div>

    <div class="badge" id="modeBadge">Mode: Motion</div>
    <div class="signal" id="signalBox"></div>

    <div class="robotSim" id="robotSim" style="display:none">
      <div id="goBadge" style="background:#0ea5e9;color:#001219;padding:10px 14px;border-radius:10px;font-weight:800">GO</div>
      <div id="stopBadge" style="background:#ef4444;color:#fff;padding:10px 14px;border-radius:10px;font-weight:800">STOP</div>
    </div>

  </div>
</div>

<script>
/* Full JS logic identical to previous provided code */
</script>
</body>
</html>